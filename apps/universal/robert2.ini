[solver]
steps = material, elasticity_operator, interpolation, constraints, newton, visualization, onetoone

[grid]
type = cell
filename = robert2
scaling = 1e-6

[grid.cytoplasm]
meshwidth = 0.5
physical = 0
shape = box
lowerleft = 0.0 0.0 0.0
size = 10.0 10.0 2.0

[grid.fibres]
fibres = first, second

[grid.fibres.first]
shape = overnucleus
meshwidth = 0.1
start = 0.07 0.07 0.0
middle = 5.0 5.0 1.5
end = 9.93 9.93 0.0
slope = 0.5
radius = 0.1
physical = 1

[grid.fibres.second]
shape = overnucleus
meshwidth = 0.1
start = 0.07 9.93 0.0
middle = 5.0 5.0 1.25
end = 9.93 0.07 0.0
slope = 0.5
radius = 0.1
physical = 2

[grid.export.vtk]
enabled = 1

[material]
materials = cyto, fibre1, fibre2

[material.cyto]
group = 0
youngs_modulus = 1000
poisson_ratio = 0.45
model = linear

[material.cyto.prestress]
type = isotropic
scale = 500

[material.fibre1]
group = 1
youngs_modulus = 300000
poisson_ratio = 0.45
model = linear

[material.fibre1.prestress]
type = curved_fibre
scale = 300000
fibre = grid.fibres.first

[material.fibre2]
group = 2
youngs_modulus = 300000
poisson_ratio = 0.45
model = linear

[material.fibre2.prestress]
type = curved_fibre
scale = 300000
fibre = grid.fibres.second

[interpolation]
functions = 0.0

[constraints]
functions = group > 0, group > 0, z<1e-12

[newton]
operator = elasticity_operator

[visualization]
steps = vis_solution, vis_vonmises, vis_physicalentity
name = robert2
