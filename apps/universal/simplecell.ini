[solver]
steps = material, interpolation, constraints, elasticity, visualization, onetoone

[grid]
type = cell
filename = spread.msh
scaling = 1e-6

[grid.cytoplasm]
shape = spread
radius = 12.5
height = 7.5
slope = 0.5
meshwidth = 0.5
physical = 0

[grid.nucleus]
shape = ellipsoid
center = 0.0 0.0 3.75
radii = 4.5 4.5 2.25
physical = 1
meshwidth = 0.5

[grid.fibres]
fibres = one

[grid.fibres.one]
shape = overnucleus
radius = 0.1
start = -12.5 0.0 -0.25
middle = 0.0 0.0 6.15
end = 12.5 0.0 -0.25
slope = 0.5
meshwidth = 0.05
physical = 2

[grid.export.geo]
enabled = 1

[grid.export.vtk]
enabled = 1

[material]
materials = cyto, nucleus, fibre

[material.cyto]
group = 0
youngs_modulus = 1000
poisson_ratio = 0.4
model = linear

[material.cyto.prestress]
type = isotropic
scale = 500

[material.nucleus]
group = 1
youngs_modulus = 10000
poisson_ratio = 0.4
model = linear

[material.fibre]
group = 2
youngs_modulus = 5000
poisson_ratio = 0.4
model = linear

[material.fibre.prestress]
type = curved_fibre
fibre = grid.fibres.one
scale = 5000

[interpolation]
functions = 0.0

[constraints]
functions = z < 1e-08

[probe]
position = 0.0 0.0 1.5e-6
name = nucleus_bottom
displace = 1

[visualization]
name = simplecell
steps = vis_solution, vis_vonmises, vis_physicalentity
